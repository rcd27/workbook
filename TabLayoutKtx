import androidx.viewpager2.widget.ViewPager2
import com.google.android.material.tabs.TabLayout

fun TabLayout.setupWithViewPager2(viewPager: ViewPager2) {

    this.apply {
        addOnTabSelectedListener(object : TabLayout.OnTabSelectedListener {
            override fun onTabReselected(tab: TabLayout.Tab?) {

            }

            override fun onTabUnselected(tab: TabLayout.Tab?) {

            }

            override fun onTabSelected(tab: TabLayout.Tab?) {
                tab?.position?.let { viewPager.setCurrentItem(it, true) }
            }
        })
    }

    viewPager.registerOnPageChangeCallback(object : ViewPager2.OnPageChangeCallback() {
        override fun onPageSelected(position: Int) {
            this@setupWithViewPager2.selectTab(this@setupWithViewPager2.getTabAt(position), true)
        }
    })
}
